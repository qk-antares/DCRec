2025-08-13 10:40:30,982 - root - INFO - Namespace(aggregator='last', batch_size=256, data='ml-1m', drop_out=0.1, dyrep=False, embedding_module='graph_attention', gpu=0, inductive=False, lr=0.0001, memory_dim=129, memory_update_at_end=False, memory_updater='gru', message_dim=100, message_function='identity', n_epoch=50, n_heads=2, n_layers=1, n_neg=10, n_neighbors=10, n_test_neg=1000, node_dim=128, patience=5, prefix='tgn-attn', randomize_features=False, seed=0, time_dim=128, train_ratio=0.8, uniform=False, use_destination_embedding_in_message=False, use_memory=True, use_source_embedding_in_message=False, valid_ratio=0.1)
2025-08-13 10:40:30,982 - root - INFO - Reading dataset ml-1m...
2025-08-13 10:40:31,093 - root - INFO - Splitting data into train, val, and test sets with ratios 0.8, 0.1...
2025-08-13 10:40:31,331 - root - INFO - The dataset has 575281 interactions, involving 9571 different nodes (6038 unique sources and 3533 unique destinations)
2025-08-13 10:40:31,331 - root - INFO - The training dataset has 460226 interactions, involving 8846 different nodes (5378 unique sources and 3468 unique destinations)
2025-08-13 10:40:31,331 - root - INFO - The validation dataset has 57527 interactions, involving 3982 different nodes (1088 unique sources and 2894 unique destinations)
2025-08-13 10:40:31,331 - root - INFO - The test dataset has 57528 interactions, involving 4252 different nodes (1220 unique sources and 3032 unique destinations)
2025-08-13 10:40:33,027 - root - INFO - Using device: cpu
2025-08-13 10:40:33,439 - root - INFO - num of training instances: 460226
2025-08-13 10:40:33,440 - root - INFO - num of batches per epoch: 1798
2025-08-13 11:50:51,264 - root - INFO - epoch: 1 took 4217.82s
2025-08-13 11:50:51,264 - root - INFO - Epoch mean loss: 0.3416376242681393
2025-08-13 11:50:51,264 - root - INFO - val MRR: 0.0357, Recall@10: 0.0686, Recall@20: 0.1236
2025-08-13 13:00:44,189 - root - INFO - epoch: 2 took 4192.90s
2025-08-13 13:00:44,189 - root - INFO - Epoch mean loss: 0.3270738444501354
2025-08-13 13:00:44,189 - root - INFO - val MRR: 0.0424, Recall@10: 0.0848, Recall@20: 0.1499
2025-08-13 14:10:46,126 - root - INFO - epoch: 3 took 4201.92s
2025-08-13 14:10:46,126 - root - INFO - Epoch mean loss: 0.3138287873634109
2025-08-13 14:10:46,126 - root - INFO - val MRR: 0.0470, Recall@10: 0.0950, Recall@20: 0.1649
