2025-09-05 09:03:07,818 - root - INFO - Namespace(aggregator='last', batch_size=256, cgfa_in_channels=None, cgfa_out_channels=128, data='ml-1m', drop_out=0.1, dyrep=False, embedding_module='graph_attention', final_hidden_dim=128, fusion_hidden_dim=256, gpu=0, inductive=False, l2_regularization=0.0001, lr=0.0001, memory_dim=129, memory_update_at_end=False, memory_updater='gru', message_dim=100, message_function='identity', model='tgn', n_epoch=50, n_heads=2, n_layers=1, n_neg=10, n_neighbors=10, n_skip_val=30, n_test_neg=1000, node_dim=128, noise_pruning_ratio=0.0, patience=5, prefix='tgn-l2-0.0001', randomize_features=False, seed=0, time_dim=128, train_ratio=0.8, uniform=False, use_destination_embedding_in_message=False, use_memory=True, use_source_embedding_in_message=False, valid_ratio=0.1)
2025-09-05 09:03:07,819 - utils.dataset - INFO - Reading dataset ml-1m...
2025-09-05 09:03:07,951 - utils.dataset - INFO - Initializing side information graphs...
2025-09-05 09:03:07,996 - utils.dataset - INFO - Maximum number of features per node: 7
2025-09-05 09:03:08,724 - utils.dataset - INFO - Splitting data into train, val, and test sets with ratios 0.8, 0.1...
2025-09-05 09:03:09,027 - utils.dataset - INFO - The dataset has 575281 interactions, involving 9571 different nodes (6038 unique sources and 3533 unique destinations)
2025-09-05 09:03:09,027 - utils.dataset - INFO - The training dataset has 460226 interactions, involving 8846 different nodes (5378 unique sources and 3468 unique destinations)
2025-09-05 09:03:09,027 - utils.dataset - INFO - The validation dataset has 57527 interactions, involving 3982 different nodes (1088 unique sources and 2894 unique destinations)
2025-09-05 09:03:09,027 - utils.dataset - INFO - The test dataset has 57528 interactions, involving 4252 different nodes (1220 unique sources and 3032 unique destinations)
2025-09-05 09:03:11,776 - root - INFO - Using device: cpu
2025-09-05 09:03:11,776 - trainer - INFO - Initializing TGN trainer
2025-09-05 09:03:11,776 - trainer - INFO - Initializing TGN trainer
2025-09-05 09:03:12,542 - trainer - INFO - num of training instances: 460226
2025-09-05 09:03:12,542 - trainer - INFO - num of batches per epoch: 1798
2025-09-05 09:03:12,542 - trainer - INFO - Skipping validation for first 30 epochs (warm-up period)
2025-09-05 09:03:12,542 - trainer - INFO - Using noise pruning with ratio: 0.0
2025-09-05 09:03:12,543 - trainer - INFO - Using L2 regularization with coefficient: 0.0001
2025-09-05 09:25:12,953 - trainer - INFO - epoch: 1 took 1320.41s
2025-09-05 09:25:12,954 - trainer - INFO - Epoch losses - Total: 0.4941, BPR: 0.3473, L2: 0.146759
2025-09-05 09:25:12,954 - trainer - INFO - Validation skipped (warm-up period)
2025-09-05 09:53:56,358 - trainer - INFO - epoch: 2 took 1723.40s
2025-09-05 09:53:56,358 - trainer - INFO - Epoch losses - Total: 0.4044, BPR: 0.3104, L2: 0.094069
2025-09-05 09:53:56,358 - trainer - INFO - Validation skipped (warm-up period)
2025-09-05 10:14:48,438 - trainer - INFO - epoch: 3 took 1252.08s
2025-09-05 10:14:48,438 - trainer - INFO - Epoch losses - Total: 0.3361, BPR: 0.2651, L2: 0.070991
2025-09-05 10:14:48,438 - trainer - INFO - Validation skipped (warm-up period)
2025-09-05 10:35:33,917 - trainer - INFO - epoch: 4 took 1245.48s
2025-09-05 10:35:33,918 - trainer - INFO - Epoch losses - Total: 0.3098, BPR: 0.2506, L2: 0.059248
2025-09-05 10:35:33,918 - trainer - INFO - Validation skipped (warm-up period)
2025-09-05 10:56:09,648 - trainer - INFO - epoch: 5 took 1235.73s
2025-09-05 10:56:09,648 - trainer - INFO - Epoch losses - Total: 0.2942, BPR: 0.2422, L2: 0.052092
2025-09-05 10:56:09,648 - trainer - INFO - Validation skipped (warm-up period)
2025-09-05 11:16:43,969 - trainer - INFO - epoch: 6 took 1234.32s
2025-09-05 11:16:43,969 - trainer - INFO - Epoch losses - Total: 0.2752, BPR: 0.2275, L2: 0.047644
2025-09-05 11:16:43,969 - trainer - INFO - Validation skipped (warm-up period)
