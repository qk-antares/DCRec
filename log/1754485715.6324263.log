2025-08-06 21:08:35,632 - root - INFO - Namespace(aggregator='last', batch_size=256, data='ml-1m', drop_out=0.1, dyrep=False, embedding_module='graph_attention', gpu=0, inductive=False, lr=0.0001, memory_dim=129, memory_update_at_end=False, memory_updater='gru', message_dim=100, message_function='identity', n_epoch=50, n_heads=2, n_layers=1, n_neg=10, n_neighbors=10, n_runs=1, n_test_neg=1000, node_dim=128, patience=5, prefix='tgn-attn', randomize_features=False, time_dim=128, train_ratio=0.8, uniform=False, use_destination_embedding_in_message=False, use_memory=True, use_source_embedding_in_message=False, valid_ratio=0.1)
2025-08-06 21:08:37,639 - root - INFO - Using device: cpu
2025-08-06 21:08:37,640 - root - INFO - Starting run 1/1
2025-08-06 21:08:38,034 - root - INFO - num of training instances: 460226
2025-08-06 21:08:38,034 - root - INFO - num of batches per epoch: 1798
2025-08-06 22:19:08,488 - root - INFO - epoch: 0 took 4230.45s
2025-08-06 22:19:08,488 - root - INFO - Epoch mean loss: 0.346582608324402
2025-08-06 22:19:08,488 - root - INFO - val MRR: 0.0402, Recall@10: 0.0763, Recall@20: 0.1271
2025-08-06 23:29:07,599 - root - INFO - epoch: 1 took 4199.10s
2025-08-06 23:29:07,599 - root - INFO - Epoch mean loss: 0.2952466606016419
2025-08-06 23:29:07,599 - root - INFO - val MRR: 0.0651, Recall@10: 0.1436, Recall@20: 0.2364
2025-08-07 00:39:33,635 - root - INFO - epoch: 2 took 4226.03s
2025-08-07 00:39:33,635 - root - INFO - Epoch mean loss: 0.2562600088795778
2025-08-07 00:39:33,635 - root - INFO - val MRR: 0.0750, Recall@10: 0.1648, Recall@20: 0.2729
2025-08-07 01:49:57,450 - root - INFO - epoch: 3 took 4223.81s
2025-08-07 01:49:57,450 - root - INFO - Epoch mean loss: 0.23753854717740228
2025-08-07 01:49:57,450 - root - INFO - val MRR: 0.0819, Recall@10: 0.1775, Recall@20: 0.2939
2025-08-07 03:00:04,249 - root - INFO - epoch: 4 took 4206.79s
2025-08-07 03:00:04,249 - root - INFO - Epoch mean loss: 0.22623777470745154
2025-08-07 03:00:04,249 - root - INFO - val MRR: 0.0912, Recall@10: 0.2008, Recall@20: 0.3194
2025-08-07 04:10:18,790 - root - INFO - epoch: 5 took 4214.53s
2025-08-07 04:10:18,790 - root - INFO - Epoch mean loss: 0.21466991893358703
2025-08-07 04:10:18,790 - root - INFO - val MRR: 0.0933, Recall@10: 0.2078, Recall@20: 0.3275
2025-08-07 05:20:22,411 - root - INFO - epoch: 6 took 4203.61s
2025-08-07 05:20:22,411 - root - INFO - Epoch mean loss: 0.20312844670985777
2025-08-07 05:20:22,411 - root - INFO - val MRR: 0.1029, Recall@10: 0.2331, Recall@20: 0.3638
2025-08-07 06:30:19,158 - root - INFO - epoch: 7 took 4196.74s
2025-08-07 06:30:19,158 - root - INFO - Epoch mean loss: 0.19665398082392366
2025-08-07 06:30:19,158 - root - INFO - val MRR: 0.1108, Recall@10: 0.2521, Recall@20: 0.3880
2025-08-07 07:40:30,605 - root - INFO - epoch: 8 took 4211.44s
2025-08-07 07:40:30,605 - root - INFO - Epoch mean loss: 0.19114996385537875
2025-08-07 07:40:30,605 - root - INFO - val MRR: 0.1116, Recall@10: 0.2567, Recall@20: 0.3945
2025-08-07 08:50:43,190 - root - INFO - epoch: 9 took 4212.58s
2025-08-07 08:50:43,190 - root - INFO - Epoch mean loss: 0.1868933600200562
2025-08-07 08:50:43,190 - root - INFO - val MRR: 0.1157, Recall@10: 0.2636, Recall@20: 0.3998
2025-08-07 10:01:58,160 - root - INFO - epoch: 10 took 4274.96s
2025-08-07 10:01:58,160 - root - INFO - Epoch mean loss: 0.18389141165109577
2025-08-07 10:01:58,160 - root - INFO - val MRR: 0.1128, Recall@10: 0.2537, Recall@20: 0.3897
2025-08-07 11:14:19,148 - root - INFO - epoch: 11 took 4340.98s
2025-08-07 11:14:19,148 - root - INFO - Epoch mean loss: 0.17959062309647694
2025-08-07 11:14:19,148 - root - INFO - val MRR: 0.1222, Recall@10: 0.2774, Recall@20: 0.4179
2025-08-07 12:25:23,622 - root - INFO - epoch: 12 took 4264.46s
2025-08-07 12:25:23,622 - root - INFO - Epoch mean loss: 0.17622773737146274
2025-08-07 12:25:23,622 - root - INFO - val MRR: 0.1269, Recall@10: 0.2929, Recall@20: 0.4324
2025-08-07 13:36:31,239 - root - INFO - epoch: 13 took 4267.61s
2025-08-07 13:36:31,239 - root - INFO - Epoch mean loss: 0.17303711546790082
2025-08-07 13:36:31,239 - root - INFO - val MRR: 0.1282, Recall@10: 0.2901, Recall@20: 0.4315
2025-08-07 14:47:38,084 - root - INFO - epoch: 14 took 4266.84s
2025-08-07 14:47:38,084 - root - INFO - Epoch mean loss: 0.17130702092116482
2025-08-07 14:47:38,085 - root - INFO - val MRR: 0.1310, Recall@10: 0.2959, Recall@20: 0.4374
2025-08-07 15:58:52,916 - root - INFO - epoch: 15 took 4274.82s
2025-08-07 15:58:52,916 - root - INFO - Epoch mean loss: 0.1691788001704932
2025-08-07 15:58:52,916 - root - INFO - val MRR: 0.1295, Recall@10: 0.2944, Recall@20: 0.4395
2025-08-07 17:10:51,203 - root - INFO - epoch: 16 took 4318.28s
2025-08-07 17:10:51,204 - root - INFO - Epoch mean loss: 0.16666840850577605
2025-08-07 17:10:51,204 - root - INFO - val MRR: 0.1346, Recall@10: 0.3028, Recall@20: 0.4481
2025-08-07 18:21:37,597 - root - INFO - epoch: 17 took 4246.38s
2025-08-07 18:21:37,597 - root - INFO - Epoch mean loss: 0.16507052284591853
2025-08-07 18:21:37,597 - root - INFO - val MRR: 0.1359, Recall@10: 0.3088, Recall@20: 0.4534
2025-08-07 19:32:02,473 - root - INFO - epoch: 18 took 4224.87s
2025-08-07 19:32:02,473 - root - INFO - Epoch mean loss: 0.1631598167983324
2025-08-07 19:32:02,473 - root - INFO - val MRR: 0.1366, Recall@10: 0.3089, Recall@20: 0.4530
2025-08-07 20:42:21,274 - root - INFO - epoch: 19 took 4218.79s
2025-08-07 20:42:21,274 - root - INFO - Epoch mean loss: 0.1621280485086632
2025-08-07 20:42:21,274 - root - INFO - val MRR: 0.1355, Recall@10: 0.3091, Recall@20: 0.4538
2025-08-07 21:52:50,759 - root - INFO - epoch: 20 took 4229.48s
2025-08-07 21:52:50,759 - root - INFO - Epoch mean loss: 0.16109014332327615
2025-08-07 21:52:50,759 - root - INFO - val MRR: 0.1388, Recall@10: 0.3152, Recall@20: 0.4593
2025-08-07 23:03:10,886 - root - INFO - epoch: 21 took 4220.12s
2025-08-07 23:03:10,886 - root - INFO - Epoch mean loss: 0.16001773384856569
2025-08-07 23:03:10,886 - root - INFO - val MRR: 0.1383, Recall@10: 0.3134, Recall@20: 0.4591
2025-08-08 00:13:23,644 - root - INFO - epoch: 22 took 4212.75s
2025-08-08 00:13:23,644 - root - INFO - Epoch mean loss: 0.1587274635129829
2025-08-08 00:13:23,644 - root - INFO - val MRR: 0.1381, Recall@10: 0.3141, Recall@20: 0.4590
2025-08-08 01:23:54,869 - root - INFO - epoch: 23 took 4231.22s
2025-08-08 01:23:54,869 - root - INFO - Epoch mean loss: 0.1576262094262776
2025-08-08 01:23:54,869 - root - INFO - val MRR: 0.1408, Recall@10: 0.3207, Recall@20: 0.4668
2025-08-08 02:34:20,061 - root - INFO - epoch: 24 took 4225.18s
2025-08-08 02:34:20,061 - root - INFO - Epoch mean loss: 0.15663593528466974
2025-08-08 02:34:20,061 - root - INFO - val MRR: 0.1428, Recall@10: 0.3216, Recall@20: 0.4679
2025-08-08 03:44:40,643 - root - INFO - epoch: 25 took 4220.57s
2025-08-08 03:44:40,644 - root - INFO - Epoch mean loss: 0.15567492567276264
2025-08-08 03:44:40,644 - root - INFO - val MRR: 0.1416, Recall@10: 0.3217, Recall@20: 0.4666
2025-08-08 04:54:43,444 - root - INFO - epoch: 26 took 4202.79s
2025-08-08 04:54:43,444 - root - INFO - Epoch mean loss: 0.15482280357379272
2025-08-08 04:54:43,444 - root - INFO - val MRR: 0.1418, Recall@10: 0.3214, Recall@20: 0.4704
2025-08-08 06:05:10,418 - root - INFO - epoch: 27 took 4226.96s
2025-08-08 06:05:10,418 - root - INFO - Epoch mean loss: 0.1539158080730409
2025-08-08 06:05:10,418 - root - INFO - val MRR: 0.1420, Recall@10: 0.3244, Recall@20: 0.4757
2025-08-08 07:16:56,793 - root - INFO - epoch: 28 took 4306.37s
2025-08-08 07:16:56,794 - root - INFO - Epoch mean loss: 0.1530194127387279
2025-08-08 07:16:56,794 - root - INFO - val MRR: 0.1458, Recall@10: 0.3312, Recall@20: 0.4786
2025-08-08 08:27:45,991 - root - INFO - epoch: 29 took 4249.19s
2025-08-08 08:27:45,991 - root - INFO - Epoch mean loss: 0.15208531489535684
2025-08-08 08:27:45,991 - root - INFO - val MRR: 0.1443, Recall@10: 0.3279, Recall@20: 0.4757
2025-08-08 09:39:41,535 - root - INFO - epoch: 30 took 4315.53s
2025-08-08 09:39:41,535 - root - INFO - Epoch mean loss: 0.15099365511563118
2025-08-08 09:39:41,535 - root - INFO - val MRR: 0.1449, Recall@10: 0.3304, Recall@20: 0.4780
2025-08-08 10:51:07,905 - root - INFO - epoch: 31 took 4286.36s
2025-08-08 10:51:07,905 - root - INFO - Epoch mean loss: 0.15079568989276554
2025-08-08 10:51:07,905 - root - INFO - val MRR: 0.1452, Recall@10: 0.3295, Recall@20: 0.4812
2025-08-08 12:02:10,546 - root - INFO - epoch: 32 took 4262.63s
2025-08-08 12:02:10,546 - root - INFO - Epoch mean loss: 0.14958650005092478
2025-08-08 12:02:10,546 - root - INFO - val MRR: 0.1465, Recall@10: 0.3345, Recall@20: 0.4849
2025-08-08 13:13:05,312 - root - INFO - epoch: 33 took 4254.76s
2025-08-08 13:13:05,312 - root - INFO - Epoch mean loss: 0.1488728871915046
2025-08-08 13:13:05,312 - root - INFO - val MRR: 0.1464, Recall@10: 0.3374, Recall@20: 0.4863
2025-08-08 14:23:41,221 - root - INFO - epoch: 34 took 4235.90s
2025-08-08 14:23:41,221 - root - INFO - Epoch mean loss: 0.1486318458132736
2025-08-08 14:23:41,221 - root - INFO - val MRR: 0.1461, Recall@10: 0.3332, Recall@20: 0.4842
2025-08-08 15:35:09,285 - root - INFO - epoch: 35 took 4288.06s
2025-08-08 15:35:09,285 - root - INFO - Epoch mean loss: 0.14812497573762767
2025-08-08 15:35:09,285 - root - INFO - val MRR: 0.1466, Recall@10: 0.3368, Recall@20: 0.4876
2025-08-08 16:45:41,709 - root - INFO - epoch: 36 took 4232.41s
2025-08-08 16:45:41,709 - root - INFO - Epoch mean loss: 0.1474292583771887
2025-08-08 16:45:41,709 - root - INFO - val MRR: 0.1477, Recall@10: 0.3385, Recall@20: 0.4880
2025-08-08 17:56:19,972 - root - INFO - epoch: 37 took 4238.25s
2025-08-08 17:56:19,972 - root - INFO - Epoch mean loss: 0.14618049130813365
2025-08-08 17:56:19,972 - root - INFO - val MRR: 0.1494, Recall@10: 0.3420, Recall@20: 0.4927
2025-08-08 19:06:59,620 - root - INFO - epoch: 38 took 4239.64s
2025-08-08 19:06:59,620 - root - INFO - Epoch mean loss: 0.14579957368906932
2025-08-08 19:06:59,620 - root - INFO - val MRR: 0.1489, Recall@10: 0.3434, Recall@20: 0.4939
2025-08-08 20:19:05,978 - root - INFO - epoch: 39 took 4326.35s
2025-08-08 20:19:05,978 - root - INFO - Epoch mean loss: 0.14514593398395317
2025-08-08 20:19:05,979 - root - INFO - val MRR: 0.1495, Recall@10: 0.3422, Recall@20: 0.4949
2025-08-08 21:30:41,992 - root - INFO - epoch: 40 took 4296.00s
2025-08-08 21:30:41,992 - root - INFO - Epoch mean loss: 0.14487180030916105
2025-08-08 21:30:41,992 - root - INFO - val MRR: 0.1500, Recall@10: 0.3434, Recall@20: 0.4929
2025-08-08 22:41:14,432 - root - INFO - epoch: 41 took 4232.43s
2025-08-08 22:41:14,432 - root - INFO - Epoch mean loss: 0.1440995523583836
2025-08-08 22:41:14,432 - root - INFO - val MRR: 0.1513, Recall@10: 0.3444, Recall@20: 0.4976
2025-08-08 23:52:06,300 - root - INFO - epoch: 42 took 4251.86s
2025-08-08 23:52:06,301 - root - INFO - Epoch mean loss: 0.14310213830840005
2025-08-08 23:52:06,301 - root - INFO - val MRR: 0.1527, Recall@10: 0.3488, Recall@20: 0.4982
2025-08-09 01:02:42,018 - root - INFO - epoch: 43 took 4235.71s
2025-08-09 01:02:42,018 - root - INFO - Epoch mean loss: 0.14284443924072984
2025-08-09 01:02:42,018 - root - INFO - val MRR: 0.1538, Recall@10: 0.3485, Recall@20: 0.4993
2025-08-09 02:13:33,202 - root - INFO - epoch: 44 took 4251.18s
2025-08-09 02:13:33,203 - root - INFO - Epoch mean loss: 0.14226160461996765
2025-08-09 02:13:33,203 - root - INFO - val MRR: 0.1521, Recall@10: 0.3448, Recall@20: 0.4960
2025-08-09 03:23:40,751 - root - INFO - epoch: 45 took 4207.54s
2025-08-09 03:23:40,752 - root - INFO - Epoch mean loss: 0.14134207623984843
2025-08-09 03:23:40,752 - root - INFO - val MRR: 0.1531, Recall@10: 0.3465, Recall@20: 0.5005
2025-08-09 04:34:11,346 - root - INFO - epoch: 46 took 4230.59s
2025-08-09 04:34:11,346 - root - INFO - Epoch mean loss: 0.14146797758039165
2025-08-09 04:34:11,346 - root - INFO - val MRR: 0.1524, Recall@10: 0.3495, Recall@20: 0.5020
2025-08-09 05:44:25,332 - root - INFO - epoch: 47 took 4213.98s
2025-08-09 05:44:25,332 - root - INFO - Epoch mean loss: 0.14125553661288157
2025-08-09 05:44:25,332 - root - INFO - val MRR: 0.1524, Recall@10: 0.3483, Recall@20: 0.5004
2025-08-09 06:55:20,914 - root - INFO - epoch: 48 took 4255.57s
2025-08-09 06:55:20,914 - root - INFO - Epoch mean loss: 0.14044983841652864
2025-08-09 06:55:20,915 - root - INFO - val MRR: 0.1537, Recall@10: 0.3470, Recall@20: 0.5023
2025-08-09 06:55:20,915 - root - INFO - No improvement over 5 epochs, stop training
2025-08-09 06:55:20,915 - root - INFO - Loading the best model at epoch 43
2025-08-09 06:55:20,919 - root - INFO - Loaded the best model at epoch 43 for inference
